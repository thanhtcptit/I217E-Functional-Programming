import System.IO

-- The data was taken taken from the following webpage:
--   http://www.data.jma.go.jp/obd/stats/etrn/view/monthly_s3.php?prec_no=44&block_no=47662

records = [ 
  (2000, [7.6, 6.0,  9.4, 14.5, 19.8, 22.5, 27.7, 28.3, 25.6, 18.8, 13.3, 8.8]),
  (2001, [4.9, 6.6,  9.8, 15.7, 19.5, 23.1, 28.5, 26.4, 23.2, 18.7, 13.1, 8.4]),
  (2002, [7.4, 7.9, 12.2, 16.1, 18.4, 21.6, 28.0, 28.0, 23.1, 19.0, 11.6, 7.2]),
  (2003, [5.5, 6.4,  8.7, 15.1, 18.8, 23.2, 22.8, 26.0, 24.2, 17.8, 14.4, 9.2]),
  (2004, [6.3, 8.5,  9.8, 16.4, 19.6, 23.7, 28.5, 27.2, 25.1, 17.5, 15.6, 9.9]),
  (2005, [6.1, 6.2,  9.0, 15.1, 17.7, 23.2, 25.6, 28.1, 24.7, 19.2, 13.3, 6.4]),
  (2006, [5.1, 6.7,  9.8, 13.6, 19.0, 22.5, 25.6, 27.5, 23.5, 19.5, 14.4, 9.5]),
  (2007, [7.6, 8.6, 10.8, 13.7, 19.8, 23.2, 24.4, 29.0, 25.2, 19.0, 13.3, 9.0]),
  (2008, [5.9, 5.5, 10.7, 14.7, 18.5, 21.3, 27.0, 26.8, 24.4, 19.4, 13.1, 9.8]),
  (2009, [6.8, 7.8, 10.0, 15.7, 20.1, 22.5, 26.3, 26.6, 23.0, 19.0, 13.5, 9.0]),
  (2010, [7.0, 6.5,  9.1, 12.4, 19.0, 23.6, 28.0, 29.6, 25.1, 18.9, 13.5, 9.9]),
  (2011, [5.1, 7.0,  8.1, 14.5, 18.5, 22.8, 27.3, 27.5, 25.1, 19.5, 14.9, 7.5]),
  (2012, [4.8, 5.4,  8.8, 14.5, 19.6, 21.4, 26.4, 29.1, 26.2, 19.4, 12.7, 7.3]),
  (2013, [5.5, 6.2, 12.1, 15.2, 19.8, 22.9, 27.3, 29.2, 25.2, 19.8, 13.5, 8.3]),
  (2014, [6.3, 5.9, 10.4, 15.0, 20.3, 23.4, 26.8, 27.7, 23.2, 19.1, 14.2, 6.7]),
  (2015, [5.8, 5.7, 10.3, 14.5, 21.1, 22.1, 26.2, 26.7, 22.6, 18.4, 13.9, 9.3]),
  (2016, [6.1, 7.2, 10.1, 15.4, 20.2, 22.4, 25.4, 27.1, 24.4, 18.7, 11.4, 8.9]),
  (2017, [5.8, 6.9,  8.5, 14.7, 20.0, 22.0, 27.3, 26.4, 22.8, 16.8, 11.9, 6.6]) ]


-- Dummy data
-- records :: [(Int, [Double])]
-- records = [
--   (2000, [9.1,14.2,19.3]),
--   (2001, [18.4,23.5,27.6]) ]

-- cell 10 = "<td>10"
cell :: Double -> String
cell x = 
  case x of
    x | x < 10 -> "<td class=cold>" ++ show x
    x | x < 15 -> "<td class=cool>" ++ show x
    x | x < 20 -> "<td class=mild>" ++ show x
    x | x < 25 -> "<td class=warm>" ++ show x
    _          -> "<td class=hot>"  ++ show x


-- row (2000, [10,20]) = "<tr><td>2000<td>10<td>20</tr>"
row :: (Int, [Double]) -> String
row (year, xs) = "<tr><td>" ++ (show year) ++ concat (map cell xs) ++ "</tr>"

-- table [r1,..,rn] =
--  "<table><tr><td>-<td>1<td>2 ... <td>12</tr>" ++
--  row r1 ++ .. ++ row rn ++ "</table>"
table :: String
table = "<table>" ++
        "<tr>"    ++
        "<th>-"   ++
        concat ["<th>" ++ show i | i <- [1..12]] ++
        [c | (year, xs) <- records, c <- row (year, xs)] ++
        "</tr>"   ++
        "</table>"

html :: String
html = 
  "<!DOCTYPE html>" ++
  "<style>" ++
  "table {" ++
  "border-top: 1px solid;" ++
  "border-bottom: 1px solid;" ++
  "}" ++
  ".cold { background: #aaf; } /* -10 */" ++
  ".cool { background: #ccf; } /* 10-15 */" ++
  ".mild { background: #fef; } /* 15-20 */" ++
  ".warm { background: #fcc; } /* 20-25 */" ++
  ".hot { background: #faa; } /* 25- */" ++
  "</style>" ++
  "<h1>Temperatures in Tokyo</h1>" ++
  table

main :: IO ()
main = do
  putStrLn html
  file <- openFile "a.html" WriteMode
  hPutStrLn file html
  hClose file